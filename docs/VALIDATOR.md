# LogicNet: Validator documentation

### Overview
The Validator is responsible for generating challenges for the Miner to solve. The Validator will receive the solutions from the Miner, evaluate them, and reward the Miner based on the quality of the solutions. The Validator will also be responsible for calculating the rewards based on the correctness and quality of the solutions.

**Protocol**: `LogicSynapse`. 
- Validator prepare:
    - `raw_logic_question`: The math problem generated from MathGenerator.
    - `logic_question`: The challenge generated by the Validator. It's rewrited by LLM from `raw_logic_question` with personalization noise.
- Miner will be provided:
    - `logic_question`: The challenge generated by the Validator.
- Miner have to fill following content in the synapse to submit the solution:
    - `logic_reasoning`: The step by step reasoning to solve the challenge.
    - `logic_answer`: The final answer of the challenge as a short sentence.

**Reward Structure**:
- `correctness (bool)`: Validator ask LLM to check the matching between `logic_answer` and the ground truth.
- `similarity (float)`: Validator compute cosine similarity between `logic_reasoning` and validator's reasoning.
- `time_penalty (float)`: Penalty for late response. It's value of `process_time / timeout * MAX_PENALTY`.

### Minimum Compute Requirements
- 1x GPU 24G (RTX 4090, A100, A6000, etc)
- Storage: 100GB

### Setup for Validator
1. Git clone the repository
```bash
git clone xxx
```
2. Install the requirements
```bash
pip install -e .
pip uninstall uvloop -y
```
3. Setup LLM Configuration
- Self host a vLLM server
```bash
pm2 start "vllm serve Qwen/Qwen2-7B-Instruct --port 8000 --host 0.0.0.0" --name "sn35-vllm" # change port and host to your preference
```
4. Change `*_BASE_URL`, `*_KEY` in `set_env.sh` file to connect to vLLM
```bash
REWARD_BASE_URL=http://localhost:8000/v1
REWARD_MODEL="Qwen/Qwen2-7B-Instruct"
REWARD_KEY="xxx"
CHALLENGE_BASE_URL=http://localhost:80000/v1
CHALLENGE_MODEL="Qwen/Qwen2-7B-Instruct"
CHALLENGE_KEY="xxx"
```
5. Create `.env` file
```bash
. set_env.sh
```
6. Run the following command to start the validator
```bash
pm2 start python --name "sn35-validator" -- neurons/validator/validator.py \
--netuid 35 --wallet.name "wallet-name" --wallet.hotkey "wallet-hotkey" \
--subtensor.network finney
```


